#!/usr/bin/make -f
DEB_DH_INSTALL_SOURCEDIR=debian/tmp

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/gnome.mk
include /usr/share/cdbs/1/rules/simple-patchsys.mk

ifeq ($(wildcard .bzr),)
EXTRA_VERSION := -rewrite-$(shell dpkg-parsechangelog | egrep '^Version:' | awk '{print $2}' | cut -d~ -f 2)
else
EXTRA_VERSION := -rewrite-bzr$(shell bzr revno)-$(shell lsb_release -cs)1-1
endif


DEB_CONFIGURE_SCRIPT := $(CURDIR)/$(DEB_SRCDIR)/autogen.sh
DEB_CONFIGURE_EXTRA_FLAGS += 	--disable-pymod-checks \
				--enable-extra-version=$(EXTRA_VERSION)

DEB_CONFIGURE_SCRIPT_ENV += LDFLAGS="-Wl,-z,defs -Wl,--as-needed"

DEB_INSTALL_MANPAGES_avant-window-navigator-trunk := debian/avant-window-navigator.1 debian/awn-applet.1
DEB_INSTALL_MANPAGES_awn-settings-trunk := debian/awn-settings.1

DEB_DH_MAKESHLIBS_ARGS_libawn0-trunk += -V"libawn0-trunk (>> 0.3.3)"
DEB_DH_MAKESHLIBS_ARGS_avant-window-navigator-trunk += -n
DEB_SHLIBDEPS_LIBRARY_avant-window-navigator-trunk:= libawn0-trunk
DEB_SHLIBDEPS_INCLUDE_avant-window-navigator-trunk := debian/libawn0-trunk/usr/
DEB_DH_STRIP_ARGS := --dbg-package=libawn0-dbg-trunk

binary-post-install/awn-settings-trunk::
	dh_pycentral -pawn-settings-trunk

binary-post-install/python-awn-trunk::
	dh_pycentral -ppython-awn-trunk
